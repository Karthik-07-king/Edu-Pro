import typing

from django.conf import settings
from ib_users.exceptions import devices_exceptions
from ib_users.interactors.storages.user_login_device_details_storage import \
    UserLoginDeviceDetailsStorage
from ib_users.constants.custom_exception_messages import \
    DEVICE_DETAILS_SHOULD_BE_GIVEN


class ValidateUserLoginDevicesDetailsInteractor:
    def __init__(self, user_login_devices_storage: UserLoginDeviceDetailsStorage):
        self.user_login_devices_storage = user_login_devices_storage

    @staticmethod
    def validate_users_login_devices(
            device_id: typing.Optional[str]):

        enable_login_devices_information = settings.ENABLE_USER_DEVICES_INFORMATION
        if enable_login_devices_information:
            if not device_id:
                raise devices_exceptions.DeviceDetailsShouldBeGivenException(
                    DEVICE_DETAILS_SHOULD_BE_GIVEN.message,
                    DEVICE_DETAILS_SHOULD_BE_GIVEN.code)
