from ib_users.interactors import dtos
from ib_users.interactors.storages.fingerprint_js_storage import \
    FingerprintJsStorage
from ib_users.models import FingerprintJsWebhookDetails, \
    UserFingerprintJsLoginDeviceDetails


class FingerprintJsStorageImpl(FingerprintJsStorage):
    def create_user_fingerprint_js_login_device_details(
            self, user_login_device_details_dto:
            dtos.UserFingerPrintJsLoginDeviceDetailsDTO):
        UserFingerprintJsLoginDeviceDetails.objects.create(
            user_id=user_login_device_details_dto.user_id,
            request_id=user_login_device_details_dto.request_id,
            device_id=user_login_device_details_dto.device_id)

    def create_fingerprint_js_webhook_details(
            self, webhook_details_dto: dtos.FingerprintJsWebhookDetailsDTO):
        FingerprintJsWebhookDetails.objects.create(
            request_id=webhook_details_dto.request_id,
            webhook_data=webhook_details_dto.webhook_data)
