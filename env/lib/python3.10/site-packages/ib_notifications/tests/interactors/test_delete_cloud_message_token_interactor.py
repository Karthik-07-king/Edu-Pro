from mock import create_autospec

from ib_notifications.constants.enums import DeviceType
from ib_notifications.interactors.delete_cloud_message_token_interactor import \
    DeleteCloudMessageTokenInteractor
from ib_notifications.interactors.storages.storage_interface import \
    StorageInterface


class TestDeleteCloudMessageTokenInteractor:
    def test_with_user_id_and_device_id_and_device_type(self):
        user_id = "1"
        device_id = "1"
        device_type = DeviceType.WEB.value

        storage_mock = create_autospec(StorageInterface)
        interactor = DeleteCloudMessageTokenInteractor(
            storage=storage_mock
        )

        interactor.delete_cloud_message_token_wrapper(
            user_id=user_id, device_type=device_type, device_id=device_id
        )

        storage_mock.delete_token_for_user_device.assert_called_once_with(
            user_id=user_id, device_id=device_id, device_type=device_type
        )
