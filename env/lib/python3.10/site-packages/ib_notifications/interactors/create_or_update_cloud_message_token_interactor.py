from ib_notifications.interactors.storages.storage_interface import \
    StorageInterface


class CreateOrUpdateCloudMessageTokenInteractor:
    def __init__(self, storage: StorageInterface):
        self.storage = storage

    def create_or_update_cloud_message_token_response(
            self, user_id: str, device_id: str,
            device_type: str, token: str):
        self.create_or_update_cloud_message_token(
            user_id=user_id,
            device_id=device_id,
            device_type=device_type,
            token=token
        )

    def create_or_update_cloud_message_token(
            self, user_id: str, device_id: str,
            device_type: str, token: str):
        self.storage.delete_tokens_for_device(
            device_id=device_id, device_type=device_type
        )
        self.storage.create_cloud_message_token(
            user_id=user_id, device_id=device_id, device_type=device_type,
            token=token
        )
