from typing import List, Tuple

from ib_notifications.dtos.notification_dto import NotificationDTO
from ib_notifications.interactors.presenters.presenter_interface import \
    PresenterInterface
from ib_notifications.interactors.storages.storage_interface import \
    StorageInterface


class GetUserNotificationsInteractor:

    def __init__(self, storage: StorageInterface):
        self.storage = storage

    def get_user_notifications_response(
            self, user_id: str, offset: int, limit: int,
            presenter: PresenterInterface):
        notifications_dtos, total_count = self.get_user_notifications(
            user_id=user_id, offset=offset, limit=limit)
        response = presenter.get_user_notifications_response(
            notification_dtos=notifications_dtos, total_count=total_count)
        return response

    def get_user_notifications(self, user_id: str, offset: int, limit: int) ->\
            Tuple[List[NotificationDTO], int]:
        notifications_dtos, total_count = self.storage.get_user_notifications(
            user_id=user_id, offset=offset, limit=limit)
        return notifications_dtos, total_count
